function registerLogin(){$("#btnLogin").on("click",function(n){var f="",t=$("#username").val(),i=$("#password").val(),r=$("#LoginCode").val(),u=$("#vclogin").val();t==NaN||t==""?(parent.pazzo.alert("請輸入會員帳號!","提示訊息"),$("#username").focus()):i==NaN||i==""?(parent.pazzo.alert("請輸入會員密碼!","提示訊息"),$("#password").focus()):r==NaN||r==""?(parent.pazzo.alert("請輸入驗證碼!","提示訊息"),$("#LoginCode").focus()):$.ajax({url:"/Member/Login",type:"POST",data:{username:t,password:i,code:r,remember:$("#rememberme").prop("checked"),validatecode:u},success:function(n){(n!=undefined||n!=null)&&(n.result?parent.window.location.href=n.redirectUrl:($("#password").val(""),parent.pazzo.alert(n.errorMsg,"提示訊息")))}}),n.preventDefault()})}function registerForgot(){$("#btnSend").on("click",function(n){var u="",t=$("#accountForgot").val(),i=$("#ForgetCode").val(),r=$("#vcforget").val();t==NaN||t==""?(parent.pazzo.alert("請輸入會員帳號 !","提示訊息"),$("#accountForgot").focus()):i==NaN||i==""?(parent.pazzo.alert("請輸入驗證碼 !","提示訊息"),$("#ForgetCode").focus()):$.ajax({url:"/Member/Forgot",type:"POST",data:{username:t,code:i,validatecode:r},success:function(n){(n!=undefined||n!=null)&&(n.result?($("#accountForgot").val(""),$("#ForgetCode").val(""),parent.pazzo.alert("已寄送新密碼至您的信箱。","提示訊息")):parent.pazzo.alert(n.errorMsg,"提示訊息"))}}),n.preventDefault()})}function focusSubNav(){var n=$("#main").length>0?$("#main").attr("code"):null,t=$("#sub").length>0?$("#sub").attr("code"):null,r=$("#item").length>0?$("#item").attr("code"):null,i=$("#DataPagerType").val();i=="OUTLET"?n==null?$(".product-menu > ul > li").each(function(){$(this).attr("code").toUpperCase()=="WOMEN"&&$(this).addClass("open")}):$(".product-menu > ul > li").each(function(){$(this).attr("code").toUpperCase()==n.toUpperCase()&&$(this).addClass("open")}):n!=null&&t==null?$(".product-menu > ul > li").each(function(){}):n!=null&&t!=null&&$(".product-menu > ul > li").each(function(){$(this).attr("code").toUpperCase()==t.toUpperCase()&&$(this).addClass("open")})}function registerMiniCartCheckout(){}function registerWishListCheck(){$(".subnav--cart-wishlist > .subnav--cart__ft > a").on("click",function(n){$(".nav-right__wish-list > p[class='nav-right__item-count']").text()=="0"?pazzo.alert("收藏清單中，無任何商品 !","提示訊息"):window.location.href="/Member/MyWishList/",n.preventDefault()})}function FormatNumber(n){n+="";var t=n.split("."),i=/(\d{1,3})(?=(\d{3})+$)/g;return t[0].replace(i,"$1,")+(t.length==2?"."+t[1]:"")}function FormatFloat(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i}function openwin(n,t,i,r,u){return u||(u="resizable=1,scrollbars=1,status=1"),i||(i=700),r||(r=500),u+=",width="+i+",height="+r,typeof screen!="undefined"&&(w_left=parseInt((screen.width-i)/2),w_top=parseInt((screen.height-r)/2),u+=",left="+w_left+",top="+w_top),oWin=window.open(n,t,u),oWin.focus(),oWin}function IsEmail(n){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(n)}function RecordNewsletter(){var n=document.getElementById("newsletter").value,t="WOMEN";IsEmail(n)==!1?(alert("請輸入正確的電子信箱格式!"),document.getElementById("newsletter").focus()):$.ajax({url:"/Home/Newsletter",type:"POST",data:{email:n,species:t},success:function(n){(n!=undefined||n!=null)&&(n.errorMessage!=null&&n.errorMessage!=""?alert(n.errorMessage):alert("電子報申請成功!"))}})}function MemberLogin(){var u="",n=document.getElementById("username").value,t=document.getElementById("password").value,i=document.getElementById("LoginCode").value,r=document.getElementById("vclogin").value;n==NaN||n==""?(parent.pazzo.alert("請輸入帳號!","提示訊息"),document.getElementById("username").focus()):t==NaN||t==""?(parent.pazzo.alert("請輸入密碼!","提示訊息"),document.getElementById("password").focus()):i==NaN||i==""?(parent.pazzo.alert("請輸入驗證碼!","提示訊息"),document.getElementById("LoginCode").focus()):$.ajax({url:"/Member/Login",type:"POST",data:{username:n,password:t,code:i,remember:$("#rememberme").prop("checked"),validatecode:r},success:function(n){(n!=undefined||n!=null)&&(n.result?parent.window.location.href=n.redirectUrl:(document.getElementById("password").value="",parent.pazzo.alert(n.errorMsg,"提示訊息")))}})}function MemberForgetPassword(){var n=$("#accountForgot").val(),i=$("#ForgetCode").val(),t=$("#vcforget").val();n==NaN||n==""?(parent.pazzo.alert("請輸入會員帳號 !","提示訊息"),$("#accountForgot").focus()):t==NaN||t==""?(parent.pazzo.alert("請輸入驗證碼 !","提示訊息"),$("#ForgetCode").focus()):$.ajax({url:"/Member/Forgot",type:"POST",data:{username:n,code:i,validatecode:t},success:function(n){(n!=undefined||n!=null)&&(n.result?($("#accountForgot").val(""),$("#ForgetCode").val(""),parent.pazzo.alert("已寄送新密碼至您的信箱。","提示訊息")):parent.pazzo.alert(n.errorMsg,"提示訊息"))}})}$(function(){registerLogin(),registerForgot(),focusSubNav(),registerMiniCartCheckout(),registerWishListCheck(),$.postJSON=function(n,t,i){$.ajax({type:"POST",url:n,data:t,timeout:3e3,async:!1,dataType:"json",success:i})}}),function(){function n(n){function t(r,u,f){if(!(this instanceof t))return new t(r,u,f);n=="confirm"?(this.$el=$(i),this.type="confirm"):(this.$el=$(i),this.$el.find(".popup__cancel").remove(),this.type="alert"),this.init(r,u,f)}var i='<div class="popup"><div class="popup__inner"><div class="popup__header"><span><\/span><\/div><div class="popup__body"><\/div><div class="popup__buttons"><a href="#" class="btn btn--small popup__cancel">取消<\/a><a href="#" class="btn btn--small popup__ok">確定<\/a><\/div><\/div><\/div>';return t.prototype={init:function(n,t){var u=this,r=Array.prototype.slice.call(arguments);this.$el.find(".popup__ok").on("click",function(n){u.close(),typeof r[1]=="function"?r[1](!0):typeof r[2]=="function"&&r[2](!0),n.preventDefault()});if(this.type=="confirm")this.$el.find(".popup__cancel").on("click",function(n){u.close(),typeof r[1]=="function"?r[1](!1):typeof r[2]=="function"&&r[2](!1),n.preventDefault()});this.open(n,t)},open:function(n,t){var u=this,i=this.$el.find(".popup__inner"),r;if(typeof n!="string")throw new Error("no msseges!");else this.$el.find(".popup__body").html(n);typeof t=="string"&&this.$el.find(".popup__header > span").html(t),this.$el.appendTo("body"),i.css("opacity",0),r=-parseInt(i.outerHeight()/2,10)+"px",setTimeout(function(){i.css({opacity:1,"margin-top":r,transform:"scale(1)"})},10)},close:function(){this.$el.remove()}},t}window.pazzo=window.pazzo||{},pazzo.alert=n(),pazzo.confirm=n("confirm")}()